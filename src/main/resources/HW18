--1 Скільки яких товірів купляли (скільки штук і чого купили всього)
select description, sum(qty)
from orders o
inner join products p on o.product = p.product_id
group by description, qty;

--2 Вивести товари, які купили більше 3-оьх разів (були в трьох і більше замовленнях)
select description, count(product)
from products p
inner join orders o on p.product_id = o.product
group by description, product
having count(product) > 3;

--3. Вивести офіси в яких працює більше трьох менеджерів
select office, city, rep_office
from (select o.office, o.city, count(rep_office) as rep_office
from offices o
inner join salesreps s on o.office = s.rep_office
group by o.office, o.city) count
where count.rep_office > 3;

--4. Вивести середній вік по офісу
select rep_office, city, avg(age)
from offices o
inner join salesreps s on o.office = s.rep_office
group by rep_office, city;

--5. Дати перелік виробників що виготовляють більше 4-ьох товарів
select mfr_id, count(mfr_id)
from products
group by mfr_id
having count(mfr_id) > 4;

--6. Дати загальну кільсть товарів, що зберігаються на складі по виробникам що виготовляють більше 4-ьох товарів
select mfr_id, sum(qty_on_hand)
from products
group by mfr_id
having count(mfr_id) > 4;

--7. Вивести імя компанії, скільки вона тратила в середньому на покупки товарів виробників, котрі виготовляють більше 4-ьох товарів
select company, o.mfr, avg(amount)
from customers c
inner join orders o on c.cust_num = o.cust
inner join (select mfr_id from products group by mfr_id having count(mfr_id) > 4) mfr on o.mfr = mfr.mfr_id
group by company, o.mfr;

--8. Вивести скільки мінімально і максимально замовлень (ордерів) виконували менеджери що мають в прямому підпорядкуванні більше двух людей
--manager, min(orders), max(orders)
select min(order_qty), max(order_qty)
from (select manager, count(order_num) order_qty
from salesreps s
inner join orders o on s.empl_num = o.rep
group by manager having count (manager) > 2);

--9. Знайти продукти в яких буква "а" зустрічається більше 2-ух раз
select description
from products
where description like '%а%а%а%';

--10. на табличках girls|boys зробить insert|update|delete. По два запити кожного типу з різною логікою
insert into girls (nm, name, city) values ('7', 'Raven', 'Hell');
update girls set city = 'LA' where name = 'Raven';
delete from girls where nm = '7' and name = 'Raven';

insert into boys (nm, name, city) values ('7', 'BeastBoy', 'Gothem');
update boys set name = 'Robin' where city = 'Gothem';
delete from boys where nm = '7' and name = 'Robin';

